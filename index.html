<!DOCTYPE html>
<html lang="th">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Franck&sa Family</title>
Â  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
Â  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: 'Kanit', sans-serif;
Â  Â  Â  background-color: #F8F0E3; /* Light cream/cookie dough background */
Â  Â  }
Â  Â  .active-btn {
Â  Â  Â  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); /* Stronger shadow */
Â  Â  Â  transform: translateY(-4px); /* More pronounced lift */
Â  Â  Â  transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy transition */
Â  Â  }
Â  Â  .btn-toggle {
Â  Â  Â  transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy transition */
Â  Â  Â  cursor: pointer; /* Indicate clickable */
Â  Â  }
Â  Â  /* Custom scrollbar for record list */
Â  Â  #recordList {
Â  Â  Â  max-height: 400px;
Â  Â  Â  overflow-y: auto;
Â  Â  Â  padding-right: 8px;
Â  Â  }
Â  Â  #recordList::-webkit-scrollbar {
Â  Â  Â  width: 8px;
Â  Â  }
Â  Â  #recordList::-webkit-scrollbar-track {
Â  Â  Â  background: #EADBC8; /* Cookie-like track */
Â  Â  Â  border-radius: 10px;
Â  Â  }
Â  Â  #recordList::-webkit-scrollbar-thumb {
Â  Â  Â  background: #DAA06D; /* Brown cookie thumb */
Â  Â  Â  border-radius: 10px;
Â  Â  }
Â  Â  #recordList::-webkit-scrollbar-thumb:hover {
Â  Â  Â  background: #B07B4C; /* Darker brown on hover */
Â  Â  }
Â  Â  /* Smooth transition for input focus */
Â  Â  input:focus, select:focus {
Â  Â  Â  transition: all 0.2s ease-in-out;
Â  Â  }
    /* Alternating row colors for better readability */
    .record-item-odd {
      background-color: #FDF8F0; /* Very light cream */
    }
    .record-item-even {
      background-color: #F8F0E3; /* Slightly darker cream (same as body background) */
    }
Â  </style>
</head>
<body>
Â  <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl p-6 md:p-10 border border-[#F0EAD6]">
Â  Â  <h1 class="text-4xl text-[#D2691E] font-extrabold text-center mb-8 tracking-wide">
Â  Â  Â  <span class="animate-pulse inline-block">ğŸª</span> Franck&sa Family <span class="animate-pulse inline-block">ğŸª</span>
Â  Â  </h1>

Â  Â  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
Â  Â  Â  <div class="bg-[#FFF8DC] p-5 rounded-xl text-center shadow-md border border-[#F0EAD6]">
Â  Â  Â  Â  <div class="text-[#D2691E] text-xl font-semibold">à¸£à¸²à¸¢à¸£à¸±à¸š</div>
Â  Â  Â  Â  <div id="totalIncome" class="text-3xl mt-2 font-bold text-[#8B4513]">à¸¿0</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="bg-[#FCE4EC] p-5 rounded-xl text-center shadow-md border border-[#F8D5E1]">
Â  Â  Â  Â  <div class="text-[#E91E63] text-xl font-semibold">à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢</div>
Â  Â  Â  Â  <div id="totalExpense" class="text-3xl mt-2 font-bold text-[#C2185B]">à¸¿0</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="bg-[#E8F5E9] p-5 rounded-xl text-center shadow-md border border-[#DDEEDD]">
Â  Â  Â  Â  <div class="text-[#4CAF50] text-xl font-semibold">à¸„à¸‡à¹€à¸«à¸¥à¸·à¸­</div>
Â  Â  Â  Â  <div id="balance" class="text-3xl mt-2 font-bold text-[#2E7D32]">à¸¿0</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="bg-white p-6 rounded-xl shadow-lg mb-8 border border-[#F0EAD6]">
Â  Â  Â  <canvas id="incomeExpenseChart" height="150"></canvas>
Â  Â  Â  <p class="text-center text-sm text-gray-500 mt-4">
Â  Â  Â  Â  à¸«à¸²à¸à¸à¸£à¸²à¸Ÿà¹„à¸¡à¹ˆà¹à¸ªà¸”à¸‡à¸œà¸¥ à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² Google Apps Script à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸›à¸à¸•à¸´à¹à¸¥à¸° URL à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
Â  Â  Â  </p>
Â  Â  </div>

Â  Â  <div class="bg-white p-6 rounded-xl shadow-lg mb-8 border border-[#F0EAD6]">
Â  Â  Â  <div class="flex justify-center gap-4 mb-5">
Â  Â  Â  Â  <button id="incomeBtn" class="btn-toggle px-8 py-3 bg-[#8B4513] text-white font-semibold rounded-full shadow-lg active-btn hover:bg-[#A0522D] focus:outline-none focus:ring-4 focus:ring-[#DAA06D]">à¸£à¸²à¸¢à¸£à¸±à¸š</button>
Â  Â  Â  Â  <button id="expenseBtn" class="btn-toggle px-8 py-3 bg-[#E91E63] text-white font-semibold rounded-full shadow-lg hover:bg-[#C2185B] focus:outline-none focus:ring-4 focus:ring-[#F8D5E1]">à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢</button>
Â  Â  Â  </div>
Â  Â  Â  <input type="text" id="description" placeholder="à¸Šà¸·à¹ˆà¸­à¸£à¸²à¸¢à¸à¸²à¸£ à¹€à¸Šà¹ˆà¸™ à¸‚à¹‰à¸²à¸§à¸«à¸¡à¸¹à¸—à¸­à¸”" class="w-full mb-4 p-3 border border-[#DAA06D] rounded-lg focus:ring-2 focus:ring-[#F0EAD6] focus:border-transparent text-gray-700 placeholder-gray-400" />
Â  Â  Â  <input type="number" id="amount" placeholder="à¸ˆà¸³à¸™à¸§à¸™à¹€à¸‡à¸´à¸™" class="w-full mb-4 p-3 border border-[#DAA06D] rounded-lg focus:ring-2 focus:ring-[#F0EAD6] focus:border-transparent text-gray-700 placeholder-gray-400" />
Â  Â  Â  <select id="category" class="w-full mb-4 p-3 border border-[#DAA06D] rounded-lg focus:ring-2 focus:ring-[#F0EAD6] focus:border-transparent bg-white text-gray-700">
Â  Â  Â  Â  <option value="à¸­à¸²à¸«à¸²à¸£">ğŸ” à¸­à¸²à¸«à¸²à¸£</option>
Â  Â  Â  Â  <option value="à¹€à¸”à¸´à¸™à¸—à¸²à¸‡">ğŸš— à¹€à¸”à¸´à¸™à¸—à¸²à¸‡</option>
Â  Â  Â  Â  <option value="à¹€à¸‡à¸´à¸™à¹€à¸”à¸·à¸­à¸™">ğŸ’¼ à¹€à¸‡à¸´à¸™à¹€à¸”à¸·à¸­à¸™</option>
Â  Â  Â  Â  <option value="à¸šà¸±à¸™à¹€à¸—à¸´à¸‡">ğŸ‰ à¸šà¸±à¸™à¹€à¸—à¸´à¸‡</option>
Â  Â  Â  Â  <option value="à¸­à¸·à¹ˆà¸™à¹†">âœï¸ à¸­à¸·à¹ˆà¸™à¹†</option>
Â  Â  Â  </select>
Â  Â  Â  <input type="date" id="date" class="w-full mb-5 p-3 border border-[#DAA06D] rounded-lg focus:ring-2 focus:ring-[#F0EAD6] focus:border-transparent text-gray-700" />
Â  Â  Â  <button id="submitBtn" onclick="submitData()" class="w-full bg-gradient-to-r from-[#D2691E] to-[#CD5C5C] hover:from-[#CD5C5C] hover:to-[#D2691E] text-white font-bold py-3 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-[#F0EAD6] active:scale-100">
Â  Â  Â  Â  ğŸª à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸²à¸¢à¸à¸²à¸£
Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div class="bg-white p-6 rounded-xl shadow-lg border border-[#F0EAD6]">
Â  Â  Â  <h2 class="text-2xl font-bold text-[#D2691E] mb-4 flex items-center gap-2">
Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-[#DAA06D]" viewBox="0 0 20 20" fill="currentColor">
Â  Â  Â  Â  Â  <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd"/>
Â  Â  Â  Â  </svg>
Â  Â  Â  Â  à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡
Â  Â  Â  </h1>
Â  Â  Â  <div id="recordList" class="text-sm space-y-4"></div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  // **à¹‚à¸›à¸£à¸”à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ URL à¸™à¸µà¹‰à¸”à¹‰à¸§à¸¢ Web app URL à¸‚à¸­à¸‡ Google Apps Script à¸‚à¸­à¸‡à¸„à¸¸à¸“**
Â  Â  // **à¸ªà¸³à¸„à¸±à¸à¸¡à¸²à¸: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹ƒà¸«à¹‰à¹à¸™à¹ˆà¹ƒà¸ˆà¸§à¹ˆà¸² URL à¸™à¸µà¹‰à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¹à¸¥à¸° Apps Script à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸–à¸¹à¸ Deploy à¹‚à¸”à¸¢à¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹€à¸›à¹‡à¸™ 'Anyone'**
Â  Â  const scriptUrl = "https://script.google.com/macros/s/AKfycbwwVD5eLWteRbTSs8AakbntCb-2iQ5lGqR3BeM8O3VEKNQt3NnAqBHrRec4lSqr1X0mKA/exec";Â 

Â  Â  const incomeBtn = document.getElementById("incomeBtn");
Â  Â  const expenseBtn = document.getElementById("expenseBtn");
Â  Â  const submitBtn = document.getElementById("submitBtn");
Â  Â  let currentType = "income";
Â  Â Â 
Â  Â  let incomeExpenseChart = null;

    // Event listeners for income/expense buttons
    incomeBtn.addEventListener('click', () => {
        currentType = 'income';
        incomeBtn.classList.add('active-btn');
        expenseBtn.classList.remove('active-btn');
        document.getElementById("amount").value = Math.abs(document.getElementById("amount").value); // Ensure positive value
    });

    expenseBtn.addEventListener('click', () => {
        currentType = 'expense';
        expenseBtn.classList.add('active-btn');
        incomeBtn.classList.remove('active-btn');
        document.getElementById("amount").value = Math.abs(document.getElementById("amount").value); // Ensure positive value
    });

Â  Â  async function fetchData() {
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch(scriptUrl + '?t=' + new Date().getTime());Â 
Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  throw new Error(`HTTP error! status: ${res.status}`);
Â  Â  Â  Â  }
Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  let totalIncome = 0, totalExpense = 0;
Â  Â  Â  Â  const list = document.getElementById("recordList");
Â  Â  Â  Â  list.innerHTML = "";Â 

Â  Â  Â  Â  const grouped = {};
Â  Â  Â  Â  data.forEach((row) => {Â 
Â  Â  Â  Â  Â  const dateOnly = toThaiDate(row.date); // à¹ƒà¸Šà¹‰ toThaiDate à¹€à¸à¸·à¹ˆà¸­à¸ˆà¸±à¸”à¸£à¸¹à¸›à¹à¸šà¸šà¸§à¸±à¸™à¸—à¸µà¹ˆ
Â  Â  Â  Â  Â  if (!grouped[dateOnly]) grouped[dateOnly] = [];
Â  Â  Â  Â  Â  grouped[dateOnly].push({Â 
Â  Â  Â  Â  Â  Â  description: row.description,Â 
Â  Â  Â  Â  Â  Â  amount: row.amount,Â 
Â  Â  Â  Â  Â  Â  date: row.date,
Â  Â  Â  Â  Â  Â  timestamp: row.timestamp,
            type: row.type // Ensure 'type' is read from fetched data (depends on Apps Script)
Â  Â  Â  Â  Â  });Â 

Â  Â  Â  Â  Â  // Calculate totals based on 'type' if available, otherwise use amount sign
Â  Â  Â  Â  Â  if (row.type === 'income') {
Â  Â  Â  Â  Â  Â  totalIncome += Math.abs(row.amount);
Â  Â  Â  Â  Â  } else if (row.type === 'expense') {
Â  Â  Â  Â  Â  Â  totalExpense -= Math.abs(row.amount); // Subtract for expense
Â  Â  Â  Â  Â  } else { // Fallback for old data without 'type'
Â  Â  Â  Â  Â  Â  if (row.amount >= 0) totalIncome += row.amount;
Â  Â  Â  Â  Â  Â  else totalExpense += row.amount;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  Object.keys(grouped).sort((a, b) => new Date(b) - new Date(a)).forEach(date => {
Â  Â  Â  Â  Â  const section = document.createElement("div");
Â  Â  Â  Â  Â  section.className = "mb-4 pb-2 border-b border-[#EADBC8] last:border-b-0";Â 
Â  Â  Â  Â  Â  section.innerHTML = `<div class="font-bold text-[#D2691E] text-lg mb-2">${date}</div>`;Â 

Â  Â  Â  Â  Â  grouped[date].forEach((row, i) => { // Added index 'i' for alternating colors
Â  Â  Â  Â  Â  Â  const item = document.createElement("div");
            // Apply alternating background colors and adjust padding/rounding
Â  Â  Â  Â  Â  Â  const rowClass = i % 2 === 0 ? 'record-item-even' : 'record-item-odd';
Â  Â  Â  Â  Â  Â  item.className = `flex flex-col sm:flex-row sm:justify-between sm:items-center py-2 px-3 rounded-lg ${rowClass}`;
Â  Â  Â  Â  Â  Â  
            // Determine class and sign based on 'type'
Â  Â  Â  Â  Â  Â  const isIncome = row.type === 'income'; // Strictly use 'type' for display
Â  Â  Â  Â  Â  Â  const amountClass = isIncome ? 'text-[#8B4513]' : 'text-[#E91E63]'; /* Cookie Run colors */
Â  Â  Â  Â  Â  Â  const amountSign = isIncome ? '+' : '-'; // Always show '-' for expense

Â  Â  Â  Â  Â  Â  item.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-800 text-sm md:text-base font-medium mr-2 mb-1 sm:mb-0">â€¢ ${row.description}</span>
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center flex-shrink-0 self-end sm:self-center">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="${amountClass} font-semibold text-xs md:text-base mr-3">${amountSign}${Math.abs(row.amount).toLocaleString()} à¸šà¸²à¸—</span>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="window.deleteRecordByValue('${row.description.replace(/'/g, "\\'")}', ${row.amount}, '${row.date}', ${row.timestamp})" class="text-gray-500 hover:text-[#E91E63] transition duration-150 ease-in-out p-1 rounded-full hover:bg-[#FCE4EC} ml-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a2 2 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  section.appendChild(item);
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  list.appendChild(section);
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById("totalIncome").textContent = `à¸¿${totalIncome.toLocaleString()}`;
Â  Â  Â  Â  document.getElementById("totalExpense").textContent = `à¸¿${Math.abs(totalExpense).toLocaleString()}`;
Â  Â  Â  Â  document.getElementById("balance").textContent = `à¸¿${(totalIncome + totalExpense).toLocaleString()}`;

Â  Â  Â  Â  renderChart(totalIncome, totalExpense);
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error fetching data:", error);
Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âŒ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸”à¹‰! à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¸° URL à¸‚à¸­à¸‡ Apps Script",
Â  Â  Â  Â  Â  duration: 5000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF4B2B, #FF416C)",
Â  Â  Â  Â  Â  stopOnFocus: true,Â 
Â  Â  Â  Â  }).showToast();
Â  Â  Â  }
Â  Â  }

Â  Â  function toThaiDate(dateStr) {
Â  Â  Â  const d = new Date(dateStr);
Â  Â  Â  const y = d.getFullYear();
Â  Â  Â  const m = String(d.getMonth() + 1).padStart(2, '0');
Â  Â  Â  const day = String(d.getDate()).padStart(2, '0');
Â  Â  Â  return `${day}/${m}/${y}`; // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™ DD/MM/YYYY
Â  Â  }

Â  Â  async function submitData() {
Â  Â  Â  if (submitBtn.disabled) return;

Â  Â  Â  const description = document.getElementById("description").value.trim();
Â  Â  Â  let amount = document.getElementById("amount").value.trim();
Â  Â  Â  const date = document.getElementById("date").value;
Â  Â  Â  const category = document.getElementById("category").value;

Â  Â  Â  if (!description || !amount || !date) {
Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âš ï¸ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸„à¸£à¸šà¸–à¹‰à¸§à¸™!",
Â  Â  Â  Â  Â  duration: 3000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF4B2B, #FF416C)",
Â  Â  Â  Â  Â  stopOnFocus: true,Â 
Â  Â  Â  Â  }).showToast();
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  amount = amount.replace(/-/g, "");
Â  Â  Â  // Always send amount as a positive number. The 'type' field will determine if it's income or expense.
Â  Â  Â  const finalAmount = parseFloat(amount); 
Â  Â  Â  // à¹€à¸à¸´à¹ˆà¸¡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š NaN à¸ªà¸³à¸«à¸£à¸±à¸š finalAmount à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡
Â  Â  Â  if (isNaN(finalAmount)) {
Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âš ï¸ à¸ˆà¸³à¸™à¸§à¸™à¹€à¸‡à¸´à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡! à¸à¸£à¸¸à¸“à¸²à¹ƒà¸ªà¹ˆà¸•à¸±à¸§à¹€à¸¥à¸‚",
Â  Â  Â  Â  Â  duration: 3000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",
Â  Â  Â  Â  Â  position: "center",
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF4B2B, #FF416C)",
Â  Â  Â  Â  Â  stopOnFocus: true,
Â  Â  Â  Â  }).showToast();
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  let payload = {
Â  Â  Â  Â  action: "add",Â 
Â  Â  Â  Â  description: `[${category}] ${description}`,
Â  Â  Â  Â  amount: finalAmount, // Amount is now always positive
Â  Â  Â  Â  date: date,
        timestamp: new Date().getTime(), // **à¹€à¸à¸´à¹ˆà¸¡à¸šà¸£à¸£à¸—à¸±à¸”à¸™à¸µà¹‰à¹€à¸à¸·à¹ˆà¸­à¸ªà¹ˆà¸‡ timestamp**
        type: currentType // Explicitly send 'income' or 'expense'
Â  Â  Â  };

Â  Â  Â  submitBtn.disabled = true;
Â  Â  Â  submitBtn.textContent = "â³ à¸à¸³à¸¥à¸±à¸‡à¸šà¸±à¸™à¸—à¸¶à¸...";

Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(scriptUrl, {
Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  headers: { "Content-Type": "application/x-www-form-urlencoded" },
Â  Â  Â  Â  Â  body: new URLSearchParams(payload).toString()
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  throw new Error(`HTTP error! status: ${response.status}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âœ… à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!",
Â  Â  Â  Â  Â  duration: 2000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #6D9773, #A5DD9B)", /* Cookie Run Green */
Â  Â  Â  Â  Â  stopOnFocus: true,
Â  Â  Â  Â  }).showToast();
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  location.reload();Â 
Â  Â  Â  Â  }, 2000);Â 
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error submitting data:", error);
Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âŒ à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ! à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¸° URL à¸‚à¸­à¸‡ Apps Script",
Â  Â  Â  Â  Â  duration: 5000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF4B2B, #FF416C)",
Â  Â  Â  Â  Â  stopOnFocus: true,Â 
Â  Â  Â  Â  }).showToast();
Â  Â  Â  } finally {
Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  submitBtn.textContent = "ğŸª à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸²à¸¢à¸à¸²à¸£";
Â  Â  Â  }
Â  Â  }


Â  Â  window.deleteRecordByValue = async function(description, amount, date, timestamp) {
Â  Â  Â  Toastify({
Â  Â  Â  Â  text: "ğŸ—‘ï¸ à¸à¸³à¸¥à¸±à¸‡à¸¥à¸šà¸£à¸²à¸¢à¸à¸²à¸£...",
Â  Â  Â  Â  duration: 1500,
Â  Â  Â  Â  close: false,
Â  Â  Â  Â  gravity: "top",
Â  Â  Â  Â  position: "center",
Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF7F50, #FF6347)",
Â  Â  Â  Â  stopOnFocus: true,
Â  Â  Â  }).showToast();

Â  Â  Â  const payload = {
Â  Â  Â  Â  action: 'deleteByValue',Â 
Â  Â  Â  Â  description: description,
Â  Â  Â  Â  amount: amount,
Â  Â  Â  Â  date: date,
Â  Â  Â  Â  timestamp: timestampÂ 
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ GET à¹€à¸›à¹‡à¸™ POST
Â  Â  Â  Â  const response = await fetch(scriptUrl, {
Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  headers: { "Content-Type": "application/x-www-form-urlencoded" },
Â  Â  Â  Â  Â  body: new URLSearchParams(payload).toString()
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  throw new Error(`HTTP error! status: ${response.status}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "ğŸ—‘ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢!",
Â  Â  Â  Â  Â  duration: 2000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #E91E63, #C2185B)", /* Cookie Run Red */
Â  Â  Â  Â  Â  stopOnFocus: true,
Â  Â  Â  Â  }).showToast();
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  location.reload();Â 
Â  Â  Â  Â  }, 2000);Â 
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error deleting data:", error);
Â  Â  Â  Â  Toastify({
Â  Â  Â  Â  Â  text: "âŒ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ! à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¸° URL à¸‚à¸­à¸‡ Apps Script",
Â  Â  Â  Â  Â  duration: 5000,
Â  Â  Â  Â  Â  close: true,
Â  Â  Â  Â  Â  gravity: "top",Â 
Â  Â  Â  Â  Â  position: "center",Â 
Â  Â  Â  Â  Â  backgroundColor: "linear-gradient(to right, #FF4B2B, #FF416C)",
Â  Â  Â  Â  Â  stopOnFocus: true,Â 
Â  Â  Â  Â  }).showToast();
Â  Â  Â  }
Â  Â  }


Â  Â  function renderChart(totalIncome, totalExpense) {
Â  Â  Â  const ctx = document.getElementById("incomeExpenseChart").getContext("2d");
Â  Â  Â  if (incomeExpenseChart) {
Â  Â  Â  Â  incomeExpenseChart.destroy();Â 
Â  Â  Â  }
Â  Â  Â  incomeExpenseChart = new Chart(ctx, {
Â  Â  Â  Â  type: 'bar',
Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  labels: ['à¸£à¸²à¸¢à¸£à¸±à¸š', 'à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢'],
Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  label: 'à¸¢à¸­à¸”à¸£à¸§à¸¡ (à¸šà¸²à¸—)',
Â  Â  Â  Â  Â  Â  data: [totalIncome, Math.abs(totalExpense)],
Â  Â  Â  Â  Â  Â  backgroundColor: ['#8B4513', '#E91E63'], /* Cookie Run Brown for Income, Pink for Expense */
Â  Â  Â  Â  Â  Â  borderRadius: 15, /* More rounded for jelly effect */
Â  Â  Â  Â  Â  Â  borderSkipped: false, /* Ensure all corners are rounded */
Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  },
Â  Â  Â  Â  options: {
Â  Â  Â  Â  Â  responsive: true,
Â  Â  Â  Â  Â  plugins: {
Â  Â  Â  Â  Â  Â  legend: { display: false },
Â  Â  Â  Â  Â  Â  tooltip: {
Â  Â  Â  Â  Â  Â  Â  enabled: true,
Â  Â  Â  Â  Â  Â  Â  callbacks: {
Â  Â  Â  Â  Â  Â  Â  Â  label: function(context) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  return context.dataset.label + ': à¸¿' + context.raw.toLocaleString();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  y: {
Â  Â  Â  Â  Â  Â  Â  beginAtZero: true,
Â  Â  Â  Â  Â  Â  Â  grid: {
Â  Â  Â  Â  Â  Â  Â  Â  color: '#EADBC8' /* Lighter grid lines */
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  ticks: {
Â  Â  Â  Â  Â  Â  Â  Â  callback: function(value) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  return 'à¸¿' + value.toLocaleString();Â 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  x: {
Â  Â  Â  Â  Â  Â  Â  grid: {
Â  Â  Â  Â  Â  Â  Â  Â  display: false
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  animation: {
Â  Â  Â  Â  Â  Â  duration: 1000, /* Slower animation for jelly effect */
Â  Â  Â  Â  Â  Â  easing: 'easeOutElastic', /* Bouncy easing function */
Â  Â  Â  Â  Â  Â  onComplete: function() {
Â  Â  Â  Â  Â  Â  Â  // Optional: Add a subtle bounce after animation completes
Â  Â  Â  Â  Â  Â  Â  // This might require a custom plugin or more advanced Chart.js features
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  }

Â  Â  function resetForm() {
Â  Â  Â  document.getElementById("description").value = "";
Â  Â  Â  document.getElementById("amount").value = "";
Â  Â  Â  document.getElementById("date").value = "";
Â  Â  Â  document.getElementById("category").value = "à¸­à¸²à¸«à¸²à¸£";Â 
Â  Â  Â  submitBtn.textContent = "ğŸª à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸²à¸¢à¸à¸²à¸£";
Â  Â  }

Â  Â  document.addEventListener("DOMContentLoaded", fetchData);
Â  </script>
</body>
</html>
